%*******************************************
\section{Teaching and Learning Content}
%*******************************************

In this section we will describe and elaborate on different teaching and learning contents which can potentially be communicated to the user.
 At the same time we will reason our decision whether to communicate the specific content or not.

\subsection{E-Mail Spoofing}
%...........................................
The first thing we tell the user in the app is that they can not trust in Mail and the sender of them.
This is exspecially important \cite{divsi2012divsi} found out that 85\% of the internet users use E-Mail to communicate but only 14\% have concerns about security regarding mail communication.

This is a problem because in contrast to public believe e-mail is in no way secured against fraud. There are three main facts that we need to transport to the user:
\begin{description}[leftmargin=0cm]
	\item[From Field] The first misbelife is that the from-field is in some way secured.
	In reality it must be considered a plaintext field.
	The problem is that most modern mail-clients used by most users hide this fact away from the user.
	Therefore we show the user with an example that anyone can send mail from any from-address.
	\item[E-Mail Content] We also have to show the user that the content of the mail is totally in the control of the sender.
	Nobody prevents the attacker from sending mails that look exactly like the once send out by a legitimate sender.
	\item[Links in E-Mails] The third information that most users are not aware of is that Links in general and Mail-Links in detail could link to any page. This means that a Link showing an URL does not need to link to that url.
\end{description}
To show the user these facts we have introduced the first part of the app.
We commonly refer to this part as the "awareness part" because it is there to increase the users awareness of the problem of Email spoofing and internet fraud.
In this part we first introduce the problem.
Thereafter the user is presented with a form that allows them to enter a sender and a target E-Mail address and a free text.
When the user submits this form we send out a Mail that has the sender and the receiver that the user entered.
The body of the mail contains a common introduction and the users free text.
It also contains a link that seems to go to a common webpage but instead links back to the app.
The template for this mail can be found in Appendix \autoref{a:mail}.

\subsection{Smartphone limitation}
%...........................................
As already discussed in \autoref{s:antiphishing_on_smartphone} smartphones have several limitations, such as the small screen size. 
This section deals with the detection of phishing on the smartphone and the related limitations.
More particularly, we will briefly explain in which ways URLs can be checked with the smartphone and what kind of problems these operations raise.
Based on this we decided whether to communicate this kind of URL checking to the user or not.

\begin{description}[leftmargin=0cm]
	\item[Invisible Address Bar] Due to lack of space most of the smartphone browsers hide the address bar~\cite{amrutkar2012measuring} and use this won space for the web content. 
By doing this, not only potential security indicators are made invisible, but also the URL that indicates with which website the user is actually interacting.
In order to make the address bar re-appear the user generally has to scroll to the top of the whole website.
The fact that the address bar containing the important information of the URL is generally hidden must be communicated to the user.
Most of the users will probably know that they can access the address bar by scrolling to the top of the website.
However, for those who might not know how to deal with that an introduction is inevitable.

	\item[Analyze Complete URL Via Address Bar] Finding the address bar will not suffice for a reasonable URL analysis. 
Here again, the small screen size makes it is impossible to view the complete URL without any further action.
Specifically, it is necessary to first tap the URL address text and then scroll the pointer to the left and right for the URL analysis.
Without learning these steps a reliable URL checking is not possible. 
Therefore, these operations steps have to be communicated to the user.

	\item[Show URL Before Click] Many mobile e-mail clients provide the functionality of showing the URL a link leads to when touching and holding the link.
However, the Android stock e-mail app, for example, does not provide this functionality.
This operation is generally available in smartphone browsers for links on websites while surfing.
Yet, one should keep in mind that it might happen that the complete URL cannot be displayed on this preview in case it is too long. 
Consequently, as discussed in \autoref{s:coverage}, deceiving the user with well-crafted, illegitimate URLs becomes possible. 
In that section we have already extensively discussed the benefits and drawbacks of teaching the user how to preview the destination URL and have decided against it.

	\item[Copy and Paste URL] Previewing the destination URL raises flaws, such as there is no guarantee that every mobile e-mail client provides this functionality and deception remains possible. 
An alternative to the preview functionality is the copy and paste functionality.
When touching and holding a link, additional to the URL preview, the option "copy URL" is available.
Upon selecting this option the destination URL is copied to the clipboard.
Now the user may paste the destination URL to any editor or even the address bar itself in order to analyze the it \textit{before} submitting.
In case the URL was pasted directly into the address bar, left and right scrolling must further be applied for the analysis. 
Also, the user must be careful not to submit the URL before checking it, otherwise he also just could have clicked on the link and checked the URL afterwards.
Analyzing the URL in a separate editor would mean to re-paste the URL into the address bar afterwards and then submit it.
We believe that either of these steps are of too high effort and thus would not be followed by the users.
Also, the user would not be able to see the "real" target in case there is a redirect included. 
Hence, this kind of possible operation will not be communicated to the user.
\end{description}

\subsection{URL Structure}
\label{s:url_structure}
The URL is a complex construct. 
In order to correctly analyze a URL and decide whether it is a spoofed or not it is necessary to understand the structure of it. 
An attacker use brands which are familiar to the user in any part of a URL in order to deceive him. 
Therefore, especially, the identification of the domain in a given URL is a key aspect which must be aimed at with the app. 
We will teach the user about the most important parts of a URL, the protocol (http vs. https), the host with its domain and the path (we do not distinguish the directory, filename or query parameters of the URL path).

\subsection{Phishing URLs}
%===========================================
As aforementioned, we focus on teaching the user how to analyze a given URL and to decide on it whether it belongs to a legitimate or illegitimate website.
 In order to distinguish legitimate URLs from phishing URLs it is necessary to analyze existent phishing URLs regarding how the URLs are spoofed in order to deceive the users.
 For the analysis of phishing URLs we chose the database of PhishTank.

PhishTank is a free community site where people can submit, verify and view phishing data.
 It provides an API which makes all PhishTank data accessible.
 Organizations such as Yahoo, Kaspersky Lab and Mcafee use the data submitted by PhishTank~\cite{phishtank}. A further deciding reason to choose PhishTank as our phishing URL database was that Kaspersky Lab itself recommended us to make use of it for our URL analysis.
 For the phishing URL analysis we made use of the URL categories which had been identified by the authors of Anti-Phishing Phil~\cite{sheng2007antiphishingphil} as a starting point.
 To these belong IP address URLs, subdomain URLs as well as similar and deceptive domain URLs.
 With these given categories we tried to assign the PhishTank URLs to the available categories.
 When no category suited the URL to be assigned, we generated a new category, to which the URL could then be assigned to.
 In addition we found various categories mentioned in literature, which we also included to our categories, even if we could not find any explicit example URL in the PhishTank database.
 In the following the identified URL categories are explained.


%...........................................
\subsubsection{Phishing URL Categorization}
%...........................................
\label{s:url_categories}
URLs are complex and many users do not know how exactly they have to be interpreted.
 For example, users can be convinced about the authenticity of an URL when it contains the brand name anywhere.
 Phishers exploit this lack of knowledge in different way.
 In the following we present the identified spoofing attacks on URLs. 
 All spoofing attacks are covered by the app unless noted otherwise.

\begin{description}[leftmargin=0cm]
	\item[Subdomain] Phishers make use of subdomains which are very similar or even identical to the domains of the spoofed target institutions.
 For example, they register a domain  ``xyz.com'' and use ``paypal'' in their subdomain, resulting in a URL such as ``http://www.paypal.xyz.com/webapps/''.
 This makes the users believe that they are on a legitimate website.

	\item[IP Address] Sometimes phishers do not even bother registering any domain at all.
 In this case, the URL to the phisher's fake website contains an IP address.

	\item[Nonsense Domain] We frequently encountered URLs which had registered quite nonsense as their domain.
 The domain names ranged from random letters to domain names like ``marketstreetchippy.
com''. Sometimes other parts of the URL contained the brand name, but sometimes there was no clue in the URL about to where it is actually leading.

	\item[Trustworthy, But Unrelated Domain] Some URLs are very well-crafted.
 When reading them they appear meaningful and trustworthy.
 This is particularly accomplished by making use of domain names which sound very trustworthy, for example, ``account-information.
com'', ``secure-login.
de'' or ``security-update.
com''. If the URL additionally contains the brand name of the target institution somewhere in the URL the user is easily deceived.

	\item[Similar and Deceptive Domains] Another possibility to fool users with a spoofed URL is to use URLs which look like the original ones, but have a slight difference.
 For example, phishers register domains which resemble the targeted domain, but has a typo.
 To spoof ``paypal.
com'', for instance, the attacker might register ``paypel.
com''. Another approach is to use a modification of the original domain.
 The modified domain contains the brand name in some form.
 For example, ``facebook-login.
com'' can be registered in order to fake ``facebook.
com''. Finally, the attacker can scramble letters of the original domain, which can be very hard to detect at first sight.

	\item[Homograph Attack] The homograph attack exploits character resemblance.
 Here characters are replaced by other characters which look very similar to the replaced one.
 For example, an attacker might replace a ``w'' within a genuine domain with ``vv'' and register it.
 An even more advanced way is to replace characters of the genuine domain with characters from other character sets, such as Cryllic languages, where the characters will look almost identical~\cite{gabrilovich2002homograph}. The latter case is indistinguishable for the human eye in many cases and is partially a technical issue.
Here, browser vendors should be encouraged to indicate when there are international characters.
 For this reason only cases that are distinguishable by the human eye are covered by the educational app.

% DAS WAS DER USER NICHT SEHEN KANN WIRD NATÜRLICH AUCH NICHT GECOVERED WERDEN KÖNNEN
	\item[Tiny URLs] A tiny URL service is used to convert a long URL into a short one.
 Due to their shortness tiny URL are very comfortable to use and easy-to-type.
 There seemed to be a trend of using tiny URLs for phishing in 2009, in particular in instant messaging services.
 Tiny URLs usually do not give a hint about the target website and users do not tend to be suspicious about receiving such links from a ``friend'' what made the use of it quite popular~\cite{tinyurlpcworld}. Tiny URLs redirect the tiny URL to the actual long URL.
 As we consider the ``analyze URL after-click'' scenario for the user education, there is no need of the tiny URL to be covered by the app.

		\item[Cloaked URLs] Other phishers integrate an ``@'' into the URL so that domain names become difficult to understand and the actual destination of a link becomes ``cloaked''\cite{alnajim2009fighting}. For example, the URL http://paypal.
com@google.
com/ is redirected to http://google.
com.
 As we consider the ``analyze URL after-click'' scenario for the user education, there is no need of the tiny URL to be covered by the app.

\end{description}

%...........................................
\subsubsection{Problems With URLs}
%...........................................
\label{s:problems_with_URLs}
There arise two major problems with the detection of phishing attacks based on the URL which are stated below. 
The succeeding sections elaborate on these problems and outline how we handle these problems.

\begin{enumerate}
	\item Some legitimate URLs feature characteristics of phishing URLs.
	\item We cannot assure that the users know all website vendors of our URLs (whether legitimate or phish).
\end{enumerate}

\begin{description}
	\item[Legitimate But Phishy Looking URLs] 
We wanted to find out to what extent phishing URL categories apply to authentic websites.
For this purpose we browsed the web and looked at legitimate websites, too. 
In detail, we visited and clicked through websites of the top 50 banks~\cite{bankrank} and top 50 online shops in Germany~\cite{onlineshoprank}. 
While surfing on these websites we have recognized that it occasionally may happen that a legitimate URL features the characteristic of a phishing URL. 
This is particularly the case for the category of similar and deceptive domains. 
There exist sites of vendors which make use of similar domains, instead of never changing the domain and using, for example, subdomains. 
An example is the website of the Commerzbank. 
When surfing on Commerzbank's website the domain is ``commerzbank.de''. 
As soon as the user is on the online banking part of the website the domain changes to ``commerzbanking.de''. 
The same happens on a PayPal website. 
The regular website features the domain ``paypal.com''.
However, paypal also has a site, where the domain is ``paypal-viewpoints.com''
By our definition, ``commerzbanking.de'' and  ``paypal-viewpoints.com'' would be a phishing website. 

We have decided to address this problem by adding a section of final remarks to the app. 
In this section we tell the user that there might be domains which are similar to domains they are familiar with and not necessarily are phishes. 
We still strongly recommend the user to directly contact the vendor before submitting data to such websites. 
The reason why we do not address this problem in the according level is that we do not want to degrade the user's attention by telling him that similar domains might still be legitimate. 
We do not consider it an issue that the user is told about this later in the app, since it is better to reject a legitimate URL than trusting a phishing URL. 

\item[Unknown Website Vendors] Even our efforts of mainly making use of URLs from widely known website vendors there is still the issue of the  possibility that a user does not know all vendors and thus the respective URL. 
One approach to address this problem is that the user has to indicate which websites he knows with the aid of a long check box, for example. 
We decided against this approach for two reasons: 
First, if a user does only know two website vendors, the list of available URLs will be quite short. 
In such a case the game experience would degrade significantly. 
Second, and more importantly, we cannot expect the users to go through a large list of vendors and let them decide whether they know them or not. 
This kind of configuration would substantially decrease the usability of our app. 
Currently, we have to let the user learn new vendors. 
This should not be a big issue. 
By making mistakes and/or giving correct answers to unknown URLs, i.e. domains, the user will eventually learn whether a given domain is legitimate or not. 
For future work, one might consider to add a ``I don't know'' button. 
In this case the user would virtually skip this URL and be explained whether it is a phish or not and why it is so.
\end{description}


\subsection{General Recommended Behavior}

In addition to these facts that we specially address in the app there are some things that we want to tell the user that are helpful when using the internet in general.
\begin{description}[leftmargin=0cm]
	\item[Do Not Download Attachment] Many users download or even open files that they receive via mail rather unchecked.
	This is related to the problem that they trust the from-field of the Mail.
	It is crucial to tell them that downloading or even opening a unknown file might infect their system.
	However, for this work we consider this as out of scope and leave it open for future work.
	\item[Data Economy] The goal of this app is to prevent that the data of the user is phished.
	The first step towards this goal is to teach the user to enter his data as rarely as possible.
	The idea behind this is not only phishing website might use the users' data in a way that he did not intend. 
	This is considered out of scope and remains as a problem to be targeted in future work.
	\item[Date Entry Via Https] We should also tell the user that he should only enter data via HTTPS. 
	When the user is entering data via HTTP there are basically two problems.
	First the user can no longer be sure that he really talks to the person he want's to talk to.
	This is captured by our precodition that DNS is assumed to be secure.
	Secondly even if he really talks to the legitimate target site he can not be sure that an attacker is not wiretapping the communication.
	Therefore the data that is send over plain HTTP can be considered lost.
	This teaching content will be part of our app, cf. \autoref{s:knowledgetransferperlevel}.	
\end{description}

%...........................................
\subsection{Browser Security Indicators}
%...........................................
As a matter for fact, there is a major lack of mobile browser security indicators~\cite{amrutkar2012measuring,trusteer2011}. 
Besides the lack of such indicators there is also the problem of inconsistencies among the mobile as well as desktop browsers.
This section deals with the security indicators of the Android standard browser which the user might potentially be told about.
Ultimately, our decision was not to tell anything about these security indicators, since they are too inconsistent even among the standard browser, depending on the device and Android version it is installed on.
\begin{description}[leftmargin=0cm]
		\item[Https Padlock] The padlock in the browser chrome is a security indicator for the usage of https.
All Android standard browsers on various devices we have examined have a padlock on SSL secured pages.
Also, one should consider that there are illegitimate as well as legitimate websites where a padlock is part of the web content. 
Therefore, it is important to teach the users to look for the padlock in the browser chrome to verify that the site they visit is SSL secured, when they enter confidential data.
However, some browsers additionally make use of so called favicons, small website icons.
The danger of using such a favicon is that a phisher could use the image of a padlock~\cite{trusteer2011} in order to deceive the user.
Moreover, the padlock with/without favicon combinations appear in different ways. 
While a part of the standard browsers installed on various devices and Android versions we have examined only feature a padlock in case of https websites and no favicon at all, others make always use of favicons. 
In the latter case, if https is used the padlock is either displayed right next to the favicon or overlaps it .
Due to the variety of possible combinations as well as the deception potential in combination with favicons we decided not to tell the user about the padlock.
		\item[Touch Padlock] Touching the padlock of an SSL secured website leads to an alert dialog with information about the website. 
One part of this information is the complete URL of the website the user is currently on.
In this case, it would become possible to view and analyze the complete URL without tapping the address bar and scrolling to the left and right.
For \textit{some} browsers which additionally make use of favicons, the above described feature is always applicable.
That means, the alert dialog with the complete URL can also be consulted on websites which do not use https.
Yet, there are also browsers where neither clicking on a padlock nor on a favicon is possible.
Hence, we will stick to our approach, where the user is explained how to analyze the URL directly in the address bar.
		\item[Certificate Verification]Tapping on the padlock icon results in an alert dialog where the user can select to view the certificate details ("show certificate").
Upon selecting this option details about the certificate will be displayed.
On the hand, while examining Android's standard browser on various devices and versions we have encountered that clicking on the padlock is not always possible. 
Hence, in these cases a validation of the certificate is not possible as well.
On the other hand, we consider the validation of certificates as out of scope for this work.
Therefore, this is an aspect which is not covered by our app.

\end{description}

%...........................................


%...........................................
\subsection{Conclusion}
%...........................................

This section briefly summarizes the above described learning contents which will be addressed by our app.

\begin{enumerate}
	\item E-mail spoofing 
	\begin{enumerate}
		\item Do not trust sender
		\item Do not trust content
		\item Target URL of a link is not necessarily the displayed one
	\end{enumerate}
	\item Invisible address bar
	\begin{enumerate}
		\item Access address bar
		\item View complete URL
	\end{enumerate}
	\item URL structure
	\item Phishing URL categories
	\begin{enumerate}
		\item Subdomain attack
		\item IP address attack
		\item Nonsense domain
		\item Trustworthy sounding, but unrelated domain
		\item Similar and deceptive domain
		\item Homograph attack
	\end{enumerate}
	\item General Recommended Behavior
	\begin{enumerate}
		\item Data entry via HTTPS only
	\end{enumerate}
	
\end{enumerate}
